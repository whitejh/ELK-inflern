# 섹션5. 도커 컴포즈로 엘라스틱 클러스터 구현하기
## 도커와 컨테이너가 필요한 이유
도커 컨테이너를 이해할려면 개발팀 운영팀의 관계와 개발에 대한 프로세스를 알아야된다.   
컨테이너는 대기업에서 프로젝트를 할 때 많이 사용한다.  
넷플릭스, 아마존, 배달의 민족, 구글 등 기업들이 대부분 쓰고 프로젝트를 시작할 때 아예 컨테이너를 기반으로 시작한다.

개발팀과 운영팀은 서로 적대적이다.  
개발팀은 개발을 하고 새로운 것을 추구한다.  
운영팀은 개발보다 안정적인 것을 추구한다.  
  
개발팀은 파이썬, 자바, 고 언어 등 다양한 언어로 개발을 하는데 그것들이 모두 충돌하지 않게 하나의 컴퓨터에 돌아갈려면 세심한 주의를 기울여야한다.  
그래서 가상환경을 사용한다. 가상환경은 충돌이 없게 하기 위해서 환경을 새롭게 구축해서 만드는 것이다.  
가상환경을 만들어놓으면 운영팀이 운영하기 쉬워진다.  
vmware나 vbox를 사용하게 되면 단점으로는 무겁다. 하드웨어를 추상화시키셔 부하가 심해진다. 

![service](./img/vmcontainer.png)

위의 그림은 vmware와 container다.
vmware은 운영체제가 굉장히 크게 들어간다.  
hypervisor라고 해서 없는 cpu, 없는 램, 없는 하드디스크 등 없는 하드웨어들을 만들어주는 역할을 하다보니 무거운 것들이 들어간다. 가상화를 해주는 것이다.  
hypervisor 대신에 docker engine이 들어가게 되면 container라는 것을 만들 수 있다.  
핵심적인 기술은 리눅스의 기술을 사용한다.  

### 리눅스 컨트롤 그룹(cGroup)
- cpu나 메모리, 네트워크 대역대 등 리소스를 제어할 수 있는 가상화 환경을 제공
- 이것을 사용해서 docker는 리눅스에서의 가상화를 이루어주고 있다.
- docker가 윈도우에 설치되면 윈도우에서 쓸 때는 hypervisor를 사용한다.
- 가능하면 리눅스 환경(ubuntu, centos 등)에서 docker를 사용하는 것을 추천한다.
- 리눅스 네임 스페이스 : 파일이나 네트워크 인터페이스를 가상화해서 자기만의 것을 가질 수 있다. (도커의 작동원리)

## 서비스 아키텍쳐
Monolith(모놀리식), Microservices(마이크로서비스)   
![service](./img/service.png)   
기존에는 모놀리식을 많이 쓰고 있었다.   
모놀리식이라는 플랫폼은 마이크로서비스들을 보통 하나의 어플리케이션에 넣고 다 같이 만든다.  
단점 : 한 번 컴파일하면 테스팅 시간이 오래 걸린다. 버그 발생하면 하루종일 점검해야 된다.

이러한 단점들 때문에 요즘에는 개발에서 마이크로서비스를 많이 사용한다.   
그 이유는 개발팀이 개별적으로 서비스를 구축할 수 있다. 서비스를 잘게 나누는 느낌   
마이크로서비스를 하게 되면 개발도 단순화할 수 있다.   
또한 개발환경이 다른 개발팀들이 새로운 기술을 각각 넣고 싶을 때  
컨테이너 환경을 쓰다보니 각자의 환경에 영향을 미치지 않고 독립적인 서비스 제공가능하다.   
복사할 때에도 모놀로식은 다 복사되지만 마이크로서비스는 따로 필요한 서비스만 복사하면 된다.

마이크로서비스를 많이 사용하는 회사들이 증가하는 이유   
: 자원의 효율성, 프로세스 단순화 때문에 컨테이너를 사용한다.   

### 마이크로서비스 아키텍쳐
의존성을 따지지 않고 컨테이너를 사용해 가상화를 하기 때문에 수백개의 서비스가 한꺼번에 돌아가도 지장 없다.   
ex) 아마존, 넷플릭스, 배달의 민족, 삼성 SDS

컨테이너를 도입하고 나서 복잡도 감소, 빌드 타입 감소 등 많은 것을 개선하고  
운영팀은 운영, 개발팀은 개발에 각자 집중할 수 있어서 스트레스도 감소한다.

도커가 많아지면 관리가 어렵다.   
쿠버네티스(kubernetes) : 도커를 관리하는 기술. ex)구글이 녹여놓은 기능을 쿠버네티스로 풀어냄   
"컨테이너"하면 "도커"를 이야기하는 경향이 있다!   
도커 - 쿠버네티스 => 컨테이너하면 대표되는 기술   
도커를 관리하는 기술들 중 하나인 쿠버네티스!!

